Running PKMS (Backend + Frontend)
Created by: GPT-5

Backend (Docker)
- From repo root:
  - docker compose up -d
- Verify:
  - curl http://localhost:8000/health
- API docs:
  - http://localhost:8000/docs
- Logs (tail):
  - docker compose logs -f pkms-backend
- Stop:
  - docker compose down

Frontend (Vite dev)
- From repo root:
  - cd pkms-frontend
  - npm run dev
- Open:
  - http://localhost:3000
- If port 3000 is busy:
  - npm run dev -- --port 5173 (then open http://localhost:5173)

Notes
- Requires Node >= 18 and npm >= 9.
- Ensure backend is running before using the app.
- Optional (local backend without Docker):
  - cd pkms-backend && pip install -r requirements.txt && uvicorn main:app --host 0.0.0.0 --port 8000

Database Management (Docker)
- Where the DB lives:
  - SQLite DB is inside Docker volume mounted at /app/data (compose volume: pkms_db_data)
  - Backups live on host at PKMS_Data/backups (mounted into container at /app/PKMS_Data/backups)

- Wipe/reset the entire DB (DESTROYS ALL DATA):
  - Option A (recommended): remove volumes and recreate
    - docker compose down -v
    - docker compose up -d
  - Option B (surgical): delete DB files inside container, then restart
    - docker exec -it pkms-backend bash -lc "rm -f /app/data/pkm_metadata.db /app/data/pkm_metadata.db-wal /app/data/pkm_metadata.db-shm"
    - docker compose restart pkms-backend
  - On next startup, tables are recreated automatically

- Backup DB (server API; requires auth):
  - POST /api/v1/backup/create  (form: backup_method=checkpoint|vacuum|all_files)
  - Resulting .db appears under PKMS_Data/backups on host

- Restore DB from backup (server API; requires auth and confirmation):
  - POST /api/v1/backup/restore  (form: backup_filename=<file>, confirm_restore=true)
  - After restore, restart recommended: docker compose restart pkms-backend

- Manual restore without API (file copy):
  - Ensure backend is stopped or will be restarted
  - docker cp PKMS_Data/backups/<backup.db> pkms-backend:/app/data/pkm_metadata.db
  - docker compose restart pkms-backend

- Find the actual Docker volume name (if needed):
  - docker volume ls --format "{{.Name}}" | grep pkms_db_data

- WAL/Checkpoint tips:
  - The system auto-checkpoints WAL; for manual: POST /api/v1/backup/manual-checkpoint (form: checkpoint_mode=FULL)
